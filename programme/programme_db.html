<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>GISRUK Programme</title>
        <script type="text/javascript" src="./d3.min.js"></script>
       <!-- <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script> -->
    </head>
    
    
    <body>
        
        <h1>Programme Database (Under Development)</h1>
        
        <!-- Placeholder for the table -->
        <table>
            <tr>
                <th>#</th>
                <th>Authors</th>
                <th>Title</th>
                <th>Group</th>
                <th>Category</th>
                <th>Abstract</th>
            </tr>
        </table>
        
        
        
        <!-- The script below does the data stuff -->
        
        <script type="text/javascript">
            var dataset; // Global variable to represent the data
            
            // Read the data. This is asynchronous, so all data handling should be done in the
            // callback function
            d3.json("./papers_db.json", function(error, data) {
                    if (error) {  //If error is not null, something went wrong.
                        console.log(error);  //Log the error.
                    } 

                    else {      //If no error, the file loaded correctly. 
                        dataset = data; // Once loaded, keep a reference to the data
                         
                        // Now call functions that reqiure the data
                        
                        populateTable();
                        
                    } // else
                    //console.log(dataset);
                    //console.log(d3.selectAll("div"))
                } // function
            ); // d3.csv
            
            /** Add relevant papers to the table */
            function populateTable() {
                
                // Not really sure how this works. Need to join rows, then columns.
                // See: https://github.com/mbostock/d3/wiki/Selections#data
                // and maybe: http://bost.ocks.org/mike/join/
                
                // Bind the rows to each line of data / json object (e.g. a paper)
                var tr = d3.select("table").selectAll("tr").data(dataset).enter().append("tr");
                
                // Now add data to each of the rows
                var td = tr.selectAll("td")
                    // Bind the data json object (a paper) to the number of <td> elements required
                    .data(function(d, i){return [d,d,d,d,d,d]}) 
                    // Create new <td> elements for each datum
                    .enter().append("td")
                    // Populate the <td> with author, title, etc
                    .text(function(d, i){return paperInfo(d,i);});
                      //.text(function(d, i){return "AA";});
                
            } // List papers
            
            
            
            /** Return a row of html for the datum 'd' */
            function paperInfo(d, i){
                switch (i) {
                        case 0: return d['PaperNo'];
                        case 1: return d['authors'];
                        case 2: return d['title'];
                        case 3: return d['Group'];
                        case 4: return d['category'];
                        //case 5: return "ABSTRACT";
                        default: return "no abstract yet";                        
                }// switch
                
//                var temp = [
//                        d['PaperNo'],
//                        d['authors'],
//                        d['title'],
//                        d['Group'],
//                        d['category'],
//                        "No abstract yet"
//                    ] ;
//                return temp;
            }
            


        </script>
        

    </body>

</html
